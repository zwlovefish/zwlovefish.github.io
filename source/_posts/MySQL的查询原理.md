---
title: MySQL的查询原理
date: 2023-06-13 00:47:10
tags: 面试,MySQL
categories: 面试
---
# 访问方法
MySQL执行查询语句的方式称为访问方法或者访问类型。同一个查询语句可以使用多种不同访问方法来执行。
## const
有时可以通过主键列来定位一条记录，如：
```sql
SELECT * FROM single_table WHERE id = 1;
```
MySQL会直接利用主键值在聚簇索引中定位对应的用户记录。与之类似，我们根据唯一索引来定位一条记录的速度也是贼快的，比如：
```sql
SELECT * FROM single_table WHERE key2=2;
```
这个查询执行可以分为两步：
1. 在uk_key对应的B+树索引中，根据key2列与常数的等值条件定位到一条二级索引记录。
2. 然后再根据该记录的id值到聚簇索引中获取到完整的用户记录。

通过主键或者唯一二级索引列与常数的等值比较来定位一条记录是像火箭一样快的，所以他们把这种通过主键或者唯一二级索引列来定位一条记录的访问方法定义为const。这种const访问方法只能在主键或者唯一二级索引列与一个常数进行等值比较时才有效。如果主键或者唯一二级索引的索引由多个列构成，则只有在索引列中的每一个列都与常数进行等值比较时，这个const访问方法才有效

对于唯一二级索引列来说，在查询列为NULL值时，情况比较特殊，如下：
```sql
SELECT * FROM single_table WHERE key2 IS NULL
```
因为唯一二级索引列并不限制NULL值的数量，所以上述语名句可能访问到多条记录，也就是说上面这个语句不可以使用const访问方法来执行

## ref

# 单表访问方法

# 连接的过程
两个表：
```sql
create table t1 (m1 int, n1 char(1))
create Table t2 (m2 int, n2 char(1))
```
连接查询中的过滤条件可以分为下面两种：
1. 涉及单表的条件：这种只涉及单表的过滤条件。比如t1.m1 > t1只针对t1表的过滤条件，t2.n2 < 'd'是只针对t2表的过滤条件。
2. 涉及两表的条件: 比如t1.m1=t2.m2、t1.n1>t2.n2等。

携带过滤条件的连接查询的大致执行过程，比如下面的这个查询语句：
```sql
SELECT * FROM t1,t2 WHERE t1.m1 = t2.m2 AND t2.n2 < 'd';
```

在这个查询中，我们指明了3个过滤条件：
1. t1.m1 > 1
2. t1.m1 = t2.m2
3. t2.n1 < 'd'
